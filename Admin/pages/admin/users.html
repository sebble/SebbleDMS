<h2>Users</h2>

<div id="ui-usertable"></div>

<h3>Management</h3>

<ul><li><a href="javascript:showDialog('new-user')">New User</a></li></ul>


<script type="text/x-jqote-template" id="tpl-usertable">
  <![CDATA[
<% loadData("User/lsl"); %>

<table cellspacing=0 cellpadding=0 data-popup="edit-user" data-popup-src="User/info">
<thead><th>id</th><th>Full Name</th></thead>
<tbody>
<% for (u in this.User_lsl) { %>
  <tr data-popup-data='{"user":"<%= this.User_lsl[u].username %>"}'><td><%= this.User_lsl[u].username %></td>
      <td><%= this.User_lsl[u].fullname %></td></tr>
<% } %>
</tbody>
</table>
  ]]>
</script>

<!--
<style>
#ui-dialog {
  width: 750px;
}
#ui-dialog form {
  overflow: auto;
}
</style>
<script>
$(window).resize(function(e){
  var wh = $(window).height();
  wh = wh - 150;
  $('#ui-dialog form').height(wh);
});
</script>
-->

<script type="text/x-jqote-template" id="tpl-edit-user">
  <![CDATA[
    <h3>Edit User</h3>
    <form action="User/setDetails" data-autoclose="true" data-refresh="true">
    <input type="hidden" name="user" value="<%= this.User_info.details.username %>" />
    <p><label>Full Name: </label><input name="fullname" autofocus value="<%= this.User_info.details.fullname %>" /></p>
    <p><label>Username: </label><input disabled value="<%= this.User_info.details.username %>" /></p>
    <p><label>Date of Birth: </label><input name='dob' value="<%= this.User_info.details.dob %>" /></p>
    <p><input type="submit" value="Okay" />
    <input type="button" class="form-cancel" value="Cancel" /></p>
    </form>
  ]]>
</script>

<script type="text/x-jqote-template" id="tpl-new-user">
  <![CDATA[
    <h3>Edit User</h3>
    <form action="User/addUser" class="fancy">
    <p><label>Full Name: </label><input name="fullname" autofocus /></p>
    <p><label>Username: </label><input name="username" /></p>
    <p><label>Date of Birth: </label><input name='dob' value="" /></p>
    <p><input type="submit" value="Create" />
    <input type="button" onclick="hideDialog()" value="Cancel" /></p>
    </form>
  ]]>
</script>
